(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{63:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h3",{attrs:{id:"前后端都需要知道的跨域"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前后端都需要知道的跨域","aria-hidden":"true"}},[t._v("#")]),t._v(" 前后端都需要知道的跨域")]),a("h4",{attrs:{id:"what-跨域"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#what-跨域","aria-hidden":"true"}},[t._v("#")]),t._v(" what 跨域")]),a("ul",[a("li",[t._v("跨域（跨域 HTTP 请求）就是前端在访问接口的时候，与访问的接口的 协议、域名、端口号 不是同一个，就会有跨域问题，这里产生跨域问题的原因是 XmlHttpRequest同源策略 ，也就是禁止使用XHR对象向不同源的服务器地址发起HTTP请求。")])]),a("h4",{attrs:{id:"why-跨域"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#why-跨域","aria-hidden":"true"}},[t._v("#")]),t._v(" why 跨域")]),a("ul",[a("li",[t._v("AJAX同源策略主要用来防止CSRF攻击。如果没有AJAX同源策略，相当危险，因为我们发起的每一次HTTP请求都会带上请求地址对应的cookie。")])]),a("h4",{attrs:{id:"请求的种类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#请求的种类","aria-hidden":"true"}},[t._v("#")]),t._v(" 请求的种类")]),a("p",[t._v("1、简单请求\n"),a("table",[a("tr",[a("td",[t._v("请求方法")]),a("td",[t._v("header")])]),a("tr",[a("td",[t._v("HEAD")]),a("td",{attrs:{rowspan:"3"}},[t._v("\nAccept、Accept-Language、Content-Language、Last-Event-ID、Content-Type(只限于三个值application/x-www-form-urlencoded、multipart/form-data、text/plain)\n")])]),a("tr",[a("td",[t._v("GET")])]),a("tr",[a("td",[t._v("POST")])])])]),a("p",[t._v("2、非简单请求")]),a("p",[t._v("除了上面的请求方法外的其他方法 delete、put 两个，还有携带其他自定义的请求头 即为非简单请求。")]),a("h4",{attrs:{id:"浏览器处理简单请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器处理简单请求","aria-hidden":"true"}},[t._v("#")]),t._v(" 浏览器处理简单请求")]),a("p",[t._v("1、基本流程")]),a("p",[t._v("先增加一个 Origin 字段，这个是直接拿的请求发起页面的http协议和域名还有端口")]),a("p",[t._v("服务端需要支持我们这个origin跨域请求，各个版本的跨域设置看文章底部。")]),a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \x3c!--必须 设置允许跨域的 origin --\x3e\n    "),a("span",{attrs:{class:"token property"}},[t._v('"Access-Control-Allow-Origin"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" string\n    \x3c!--可选 设置允许跨域请求带的 requset header --\x3e\n    "),a("span",{attrs:{class:"token property"}},[t._v('"Access-Control-Allow-Headers"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" String\n    \x3c!--可选 设置允许跨域的 Methods --\x3e\n    "),a("span",{attrs:{class:"token property"}},[t._v('"Access-Control-Allow-Methods"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" String\n    \x3c!--可选 设置允许跨域的 cookie"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" 开启此字段，前端 ajax 需要 设置withCredentials 且 Access-Control-Allow-Origin 不能为 *  --\x3e\n    "),a("span",{attrs:{class:"token property"}},[t._v('"Access-Control-Allow-Credentials"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" Boolean\n    \x3c!--可选 设置option预检请求的缓存时间 --\x3e\n    "),a("span",{attrs:{class:"token property"}},[t._v('"Access-Control-Max-Age"')]),a("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" Number\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("h4",{attrs:{id:"浏览器处理复杂请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器处理复杂请求","aria-hidden":"true"}},[t._v("#")]),t._v(" 浏览器处理复杂请求")]),a("ul",[a("li",[t._v("复杂请求在跨域请求的时候浏览器会发送一个预检请求，method 为 option，服务端需要首先通过验证这个预检请求，给这个请求返回 200 ，此时的 header 和 method 必须和 "),a("code",[t._v("access-control-allow")]),t._v(" 中设置的保持一致。浏览器收到 option 响应，确认设置的 method 和 header 对上了，认为预检通过了，就开始正式的发送这个请求。")])]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 一次option预请求\n:authority: i-863.kaixindou.net\n:method: OPTIONS\n:path: /gameInfo/fetchPkWinStreakShareInfo?uid=101001638&streakWin=3\n:scheme: https\naccept: */*\naccept-encoding: gzip, deflate, br\naccept-language: zh-CN,zh;q=0.9\naccess-control-request-headers: x-lang,x-ostype\naccess-control-request-method: GET\norigin: https://www.kaixindou.net\nuser-agent: Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Mobile Safari/537.36\n")])]),a("ul",[a("li",[t._v("预检请求的允许通过，此时预检请求返回 200 在 "),a("code",[t._v("preview")]),t._v(" 中看到 200 或者一个空页面")])]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("access-control-allow-credentials: true\naccess-control-allow-headers: x-lang, x-ostype\naccess-control-allow-methods: OPTIONS,GET,POST\naccess-control-allow-origin: https://www.kaixindou.net\ncontent-length: 0\ndate: Wed, 15 Aug 2018 13:09:38 GMT\nserver: nginx\nstatus: 200\nvary: Access-Control-Request-Method\nvary: Origin\nvary: Access-Control-Request-Headers\n")])]),a("ul",[a("li",[t._v("预检请求不允许通过，预检请求同样返回 200 ，在  "),a("code",[t._v("preview")]),t._v(" 中看到 nothing to preview，response没有返回 "),a("code",[t._v("access-control-allow")]),t._v(" 相关字段\n"),a("ul",[a("li",[t._v("header 报错")])]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// console 的报错\nRequest header field xxxx is not allowed by Access-Control-Allow-Headers in preflight response.\n")])]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 网络请求的 response\nContent-Type: application/json; charset=utf-8\n")])]),a("ul",[a("li",[t._v("origin 报错")])]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// console 的报错\nOrigin xxxxxxxxxx is not allowed by Access-Control-Allow-Origin.\n")])]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 网络请求的 response\nContent-Type: application/json; charset=utf-8\n")])])])]),a("h4",{attrs:{id:"怎么避免这个预请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#怎么避免这个预请求","aria-hidden":"true"}},[t._v("#")]),t._v(" 怎么避免这个预请求")]),a("ul",[a("li",[t._v("我们一般开发，会涉及到预请求的无非就是设置了其他的 header，方法我们也只是用到 get 和 post")])]),a("ol",[a("li",[t._v("让服务端缓存我们的预请求")])]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// 让服务器设置下面这个头，在多次请求的时候可以避免二次预检\nAccess-Control-Max-Age: ms\n")])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("和服务端协商，设置的 header 使用 Last-Event-ID 等浏览器预置的 header，从根本上避免 option 的预请求")])]),a("h4",{attrs:{id:"开发中遇到的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发中遇到的问题","aria-hidden":"true"}},[t._v("#")]),t._v(" 开发中遇到的问题")]),a("ul",[a("li",[t._v("jq的 ajax 的携带 header 好坑，怎么都带不上去，建议使用 "),a("a",{attrs:{href:"https://www.kancloud.cn/yunye/axios/234845",target:"_blank",rel:"noopener noreferrer"}},[t._v("axios")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("// axios比较烦的 get 请求和 post 请求的参数位不一样,建议使用自己简单封装下\nAxios({\n  url: url[region] + '/wemeet/set_img_status',\n  method: 'post',\n  data: data,// post 使用\n  param: data,// get 使用\n  headers: { 'X-Auth-Token': encodeURIComponent(token) }\n}).then(rsp => rsp.data).catch(err => {\n  console.log(err.message)\n})\n")])])]),a("li",[t._v("封装过的"),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("export const axios = (url, type = 'GET', data = {}) => {\n  if (typeof url === 'object') {\n    return Axios(url)\n  }\n  if (typeof type === 'object') {\n    data = type\n    type = 'GET'\n  }\n  const axiosData = {\n    withCredentials: true,\n    method: type,\n    url\n  }\n  if (type === 'GET') {\n    axiosData.params = data\n  }\n  if (type === 'POST') {\n    axiosData.data = data\n  }\n  axiosData.headers = { header: '12321' }\n  return Axios(`${url}`, axiosData).then(rsp => {\n    console.log(`${url}`, rsp.data)\n    return rsp.data\n  }).catch(e => {\n    alert(e.message)\n  })\n}\n")])])])]),a("h3",{attrs:{id:"附录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附录","aria-hidden":"true"}},[t._v("#")]),t._v(" 附录")]),a("ul",[a("li",[t._v("node express 跨域设置")])]),a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{attrs:{class:"token comment"}},[t._v("// 使用express中间件")]),t._v("\n"),a("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" whiteList "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" xx"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com "),a("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\napp"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("use")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v("'*'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" next"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" origin "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" req"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("origin\n\t"),a("span",{attrs:{class:"token keyword"}},[t._v("let")]),t._v(" allowOrigin "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'http://fe.xx.com'")]),t._v("\n\torigin "),a("span",{attrs:{class:"token operator"}},[t._v("&&")]),t._v(" whiteList"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("forEach")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v "),a("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("origin"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("indexOf")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{attrs:{class:"token operator"}},[t._v("-")]),a("span",{attrs:{class:"token number"}},[t._v("1")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tallowOrigin "),a("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" origin\n\t\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tres"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("header")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Origin"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" allowOrigin"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tres"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("header")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Headers"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"Content-Type, Authorization, X-Requested-With"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tres"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("header")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Methods"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"PUT,POST,GET,DELETE,OPTIONS"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    res"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("header")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Credentials"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token boolean"}},[t._v("true")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    res"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("header")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Access-Control-Max-Age"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("1728000")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\tres"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("header")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"X-Powered-By"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'3.2.1'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method "),a("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v("'OPTIONS'")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t  res"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("send")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token number"}},[t._v("200")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t  "),a("span",{attrs:{class:"token function"}},[t._v("next")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),a("ul",[a("li",[t._v("go 跨域设置")])]),a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("allowCrossOrigin")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rw http"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ResponseWriter"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req "),a("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("http"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Request"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" strings"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("ContainsAny")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Header"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Origin"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"yy.com"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\trw"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Header")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Origin"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Header"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Origin"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\trw"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Header")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Method"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"PUT,OPTIONS,POST,GET"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\trw"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Header")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Credentials"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"true"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\trw"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Header")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Set")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Headers"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"Content-Type, X-Auth-Token"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),a("span",{attrs:{class:"token function"}},[t._v("HttpGetImgList")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rw http"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ResponseWriter"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req "),a("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("http"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Request"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" req"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Method "),a("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" http"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MethodOptions "),a("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),a("span",{attrs:{class:"token function"}},[t._v("allowCrossOrigin")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rw"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \tcom_http"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("SendCommonResp")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rw"),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("URL"),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Query")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{attrs:{class:"token function"}},[t._v("Get")]),a("span",{attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{attrs:{class:"token string"}},[t._v('"callback"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token number"}},[t._v("0")]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('"r u ok"')]),a("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{attrs:{class:"token string"}},[t._v('""')]),a("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \t"),a("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v("\n    "),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),a("h5",{attrs:{id:"参考链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考链接","aria-hidden":"true"}},[t._v("#")]),t._v(" 参考链接")]),a("ul",[a("li",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#HTTP_%E5%93%8D%E5%BA%94%E9%A6%96%E9%83%A8%E5%AD%97%E6%AE%B5",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP访问控制（CORS）")])]),a("li",[a("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2016/04/cors.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("跨域资源共享 CORS 详解")])]),a("li",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/28562290",target:"_blank",rel:"noopener noreferrer"}},[t._v("跨域的那些事儿")])]),a("li",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP Headers")])])])])}],!1,null,null,null);s.default=e.exports}}]);